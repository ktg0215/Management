# 店舗・従業員統合管理システム ユーザーマニュアル

**最終更新**: 2025年12月  
**バージョン**: 2.0.0

---

## 目次

1. [システム概要](#1-システム概要)
2. [ログイン方法](#2-ログイン方法)
3. [一般ユーザー（従業員）向け機能](#3-一般ユーザー従業員向け機能)
4. [管理者向け機能](#4-管理者向け機能)
5. [総管理者向け機能](#5-総管理者向け機能)
6. [CSV出力機能](#6-csv出力機能)
7. [よくある質問](#7-よくある質問)

---

## 1. システム概要

### 1.1 システムの目的

本システムは、複数店舗を持つ企業の以下の業務を一元管理するためのWebアプリケーションです：

- **シフト管理**: 従業員のシフト提出・承認・管理
- **売上管理**: 日次・月次売上データの入力・集計・分析
- **損益管理**: P&L（損益計算書）の作成・管理
- **支払い管理**: 取引先への支払い履歴管理
- **取引先管理**: 取引先企業情報の管理
- **従業員管理**: 従業員情報の管理
- **店舗管理**: 店舗情報の管理

### 1.2 ユーザー権限について

本システムには3つの権限レベルがあります：

| 権限 | 説明 | 主な機能 |
|------|------|----------|
| **一般ユーザー** | 従業員 | シフト提出、自分の履歴確認 |
| **管理者** | 店舗管理者 | 所属店舗の管理、シフト承認、売上管理、従業員管理 |
| **総管理者** | システム管理者 | 全店舗・全業態の完全管理、システム設定変更 |

---

## 2. ログイン方法

### 2.1 ログイン画面へのアクセス

1. ブラウザでシステムのURLにアクセスします
2. ログイン画面が表示されます

### 2.2 ログイン手順

1. **従業員ID**を入力します
   - 数字または文字列が使用可能です
   - 最大50文字まで入力可能です

2. **パスワード**を入力します

3. **ログイン**ボタンをクリックします

### 2.3 ログイン後の画面

ログインに成功すると、権限に応じて以下の画面に自動的にリダイレクトされます：

- **一般ユーザー**: 従業員ダッシュボード（`/employee/dashboard`）
- **管理者・総管理者**: 管理者ダッシュボード（`/admin/dashboard`）

### 2.4 ログアウト方法

画面右上の**ログアウト**ボタンをクリックすると、ログアウトしてログイン画面に戻ります。

---

## 3. 一般ユーザー（従業員）向け機能

### 3.1 ダッシュボード

**アクセス**: `/employee/dashboard`

ダッシュボードでは、以下の情報を確認できます：

- **個人プロフィール**: 氏名、所属店舗、勤怠番号
- **今月のシフト提出状況**: 提出済み/未提出の確認
- **次回提出期限**: 次回のシフト提出期限
- **勤務時間合計**: 今月の勤務時間の合計

### 3.2 シフト提出

**アクセス**: `/employee/shifts`

#### 3.2.1 シフト提出の流れ

1. **期間を選択**
   - 年月を選択します
   - シフト期間は以下の2つに分かれています：
     - **前半**: 1日〜15日
     - **後半**: 16日〜月末

2. **シフトを入力**
   - カレンダー表示で各日付をクリック
   - **出勤時間**と**退勤時間**を入力
   - 休日の場合は**休日**チェックボックスにチェック

3. **保存**
   - **保存**ボタンをクリックして下書き保存
   - または、各日付の入力後に自動保存

4. **提出**
   - **提出**ボタンをクリックしてシフトを提出
   - 提出後は編集できません（管理者に確認を依頼してください）

#### 3.2.2 提出期限

- **前半（1-15日）**: 前月20日まで
- **後半（16日-月末）**: 当月5日まで

#### 3.2.3 シフト入力のコツ

- **一括コピー**: 前の期間のシフトをコピーして編集できます
- **休日設定**: 休日の場合は時間入力不要です
- **下書き保存**: 提出前に何度でも編集可能です

---

## 4. 管理者向け機能

### 4.1 ダッシュボード

**アクセス**: `/admin/dashboard`

管理者ダッシュボードでは、以下の情報を確認できます：

- **店舗数**: 管理対象の店舗数
- **従業員数**: 管理対象の従業員数
- **今月のシフト提出率**: シフト提出の進捗状況
- **今月の売上（速報）**: 売上の概況
- **最新アクティビティ**: システム内の最新の操作履歴

### 4.2 シフト管理

**アクセス**: `/admin/shifts`

#### 4.2.1 シフト提出状況の確認

1. **店舗を選択**
   - ドロップダウンから店舗を選択します

2. **期間を選択**
   - 年月と前半/後半を選択します

3. **提出状況を確認**
   - **提出済み**: 緑色で表示
   - **未提出**: 赤色で表示
   - **提出率**: 全体の提出率が表示されます

#### 4.2.2 シフト詳細の確認

- 従業員名をクリックすると、その従業員のシフト詳細を確認できます
- 出勤時間・退勤時間・休日設定が表示されます

#### 4.2.3 Excel出力

1. **店舗**と**期間**を選択します
2. **Excelで出力**ボタンをクリックします
3. Excelファイルがダウンロードされます
4. テンプレート形式で出力され、編集可能です

### 4.3 売上管理

**アクセス**: `/admin/sales-management`

#### 4.3.1 日次売上データの入力

1. **店舗**を選択します（総管理者の場合）
2. **年月**を選択します
3. **データ入力**ボタンをクリックします
4. 日付を選択して、売上データを入力します

#### 4.3.2 入力項目

売上管理では、以下のような項目を入力できます：

- **基本情報**: 日付、曜日
- **売上関連**: 店舗純売上、EDW純売上、OHB純売上、売上目標など
- **客数・組数**: 組数（計）、客数（計）、組単価、客単価など
- **人件費関連**: 社員時間、AS時間、人時売上高、人件費額、人件費率など
- **その他**: VOID件数、VOID金額、売上金過不足など

※ 表示される項目は、業態によって異なります。

#### 4.3.3 データの更新

- **更新**ボタンをクリックすると、最新のデータを取得します
- データは自動的に保存されます

#### 4.3.4 CSV出力

詳細は[6. CSV出力機能](#6-csv出力機能)を参照してください。

### 4.4 月次売上管理

**アクセス**: `/admin/monthly-sales`

#### 4.4.1 月次データの確認・入力

1. **データ読み込み**ボタンをクリックして、最新データを取得します
2. 店舗ごとの月次データが表示されます
3. データをクリックすると、編集画面が開きます

#### 4.4.2 月次データの編集

- 各項目を入力・編集できます
- 自動計算項目は自動的に計算されます
- **保存**ボタンをクリックして保存します

#### 4.4.3 CSV出力

詳細は[6. CSV出力機能](#6-csv出力機能)を参照してください。

### 4.5 損益（P&L）管理

**アクセス**: `/admin/pl-create`

#### 4.5.1 P&Lの作成

1. **店舗**を選択します
2. **年月**を選択します
3. **新規作成**ボタンをクリックします

#### 4.5.2 P&L項目の入力

- **科目名**: 損益項目の名称
- **見込**: 予算・見込み金額
- **実績**: 実際の金額
- **ハイライト**: 重要な項目にチェック
- **小計**: 小計行にチェック
- **インデント**: 階層表示のためのインデント設定

#### 4.5.3 P&Lの保存

- **保存**ボタンをクリックして保存します
- 保存後は、年次損益推移画面で確認できます

### 4.6 支払い管理

**アクセス**: `/admin/payments`

#### 4.6.1 支払い履歴の確認

1. **店舗**を選択します
2. **年月**を選択します
3. その月の支払い履歴が表示されます

#### 4.6.2 支払いデータの追加

1. **新規追加**ボタンをクリックします
2. 以下の情報を入力します：
   - **取引先**: 取引先を選択（または新規作成）
   - **支払月**: 支払い月を選択
   - **金額**: 支払い金額を入力
   - **備考**: 備考を入力（任意）

3. **保存**ボタンをクリックします

#### 4.6.3 支払いデータの編集・削除

- 一覧からデータを選択して、**編集**または**削除**ボタンをクリックします

#### 4.6.4 月次支払総額

- 選択した月の支払い総額が自動的に計算されて表示されます

### 4.7 取引先管理

**アクセス**: `/admin/companies`

#### 4.7.1 取引先の登録

1. **新規追加**ボタンをクリックします
2. 以下の情報を入力します：
   - **取引先名**: 必須
   - **銀行名**: 任意
   - **支店名**: 任意
   - **口座種別**: 普通/当座から選択
   - **口座番号**: 任意
   - **科目**: 経費科目を選択（損益管理の科目から選択可能）
   - **支払いタイプ**: 
     - **定期支払い（毎月）**: 毎月支払う
     - **定期支払い（選択した月）**: 指定した月のみ支払う
     - **不定期支払い**: 不定期に支払う
   - **定期支払い金額**: 定期支払いの場合の金額
   - **支払い月**: 選択した月のみ支払う場合の月を選択
   - **表示/非表示**: 一覧に表示するかどうか

3. **保存**ボタンをクリックします

#### 4.7.2 取引先の編集・削除

- 一覧から取引先を選択して、**編集**または**削除**ボタンをクリックします
- **注意**: 支払いデータが存在する取引先は削除できません

### 4.8 従業員管理

**アクセス**: `/admin/employees`

#### 4.8.1 従業員の追加

1. **新規追加**ボタンをクリックします
2. 以下の情報を入力します：
   - **勤怠番号**: 必須、ユニーク
   - **氏名**: 必須
   - **ニックネーム**: 必須
   - **所属店舗**: 必須
   - **権限**: 一般ユーザー/管理者から選択
   - **パスワード**: 必須、8文字以上

3. **保存**ボタンをクリックします

#### 4.8.2 従業員の編集・削除

- 一覧から従業員を選択して、**編集**または**削除**ボタンをクリックします
- **削除**: 論理削除（無効化）されます

#### 4.8.3 フィルタリング

- **業態**: 業態でフィルタ（総管理者のみ）
- **店舗**: 店舗でフィルタ
- **権限**: 権限でフィルタ
- **有効/無効**: 有効な従業員のみ表示するかどうか

---

## 5. 総管理者向け機能

総管理者は、管理者の機能に加えて、以下の機能が利用できます：

### 5.1 店舗管理

**アクセス**: `/admin/stores`

#### 5.1.1 店舗の追加

1. **新規追加**ボタンをクリックします
2. 以下の情報を入力します：
   - **店舗名**: 必須
   - **業態**: 業態を選択

3. **保存**ボタンをクリックします

#### 5.1.2 店舗の編集・削除

- 一覧から店舗を選択して、**編集**または**削除**ボタンをクリックします

### 5.2 業態管理

**アクセス**: `/admin/business-types`

#### 5.2.1 業態の追加

1. **新規追加**ボタンをクリックします
2. 以下の情報を入力します：
   - **業態名**: 必須
   - **説明**: 任意

3. **保存**ボタンをクリックします

#### 5.2.2 業態の編集・削除

- 一覧から業態を選択して、**編集**または**削除**ボタンをクリックします

### 5.3 売上管理の表示項目設定

**アクセス**: `/admin/sales-field-settings`

#### 5.3.1 表示項目の設定

1. **業態**を選択します
2. 表示する項目を選択します：
   - **表示**: チェックボックスにチェック
   - **非表示**: チェックボックスを外す
   - **日次売上管理で表示**: 日次売上管理画面で表示するかどうか
   - **月次売上管理で表示**: 月次売上管理画面で表示するかどうか

3. **保存**ボタンをクリックします

#### 5.3.2 項目の並び順

- 項目は**表示順序**で並び替えられます
- 順序を変更する場合は、項目設定画面で順序を調整してください

### 5.4 月次売上管理の業態別項目設定

**アクセス**: `/admin/monthly-sales` → **業態別項目設定**タブ

#### 5.4.1 項目の追加

1. **新規追加**ボタンをクリックします
2. 以下の情報を入力します：
   - **項目名**: 必須
   - **カテゴリ**: 売上関連/客数・客単価/利益関連などから選択
   - **タイプ**: 数値/通貨/パーセンテージ/テキスト/件数から選択
   - **単位**: 円、%、時間など
   - **必須**: 必須項目かどうか
   - **自動計算**: 自動計算項目かどうか
   - **計算式**: 自動計算の場合の計算式

3. **保存**ボタンをクリックします

#### 5.4.2 項目の編集・削除

- 一覧から項目を選択して、**編集**または**削除**ボタンをクリックします

### 5.5 管理者アカウントの作成

**アクセス**: `/admin/add-admin`

#### 5.5.1 管理者アカウントの作成

1. 以下の情報を入力します：
   - **勤怠番号**: 必須、ユニーク
   - **氏名**: 必須
   - **ニックネーム**: 必須
   - **所属店舗**: 必須
   - **パスワード**: 必須、8文字以上

2. **作成**ボタンをクリックします

---

## 6. CSV出力機能

### 6.1 売上管理のCSV出力

**アクセス**: `/admin/sales-management` → **CSV出力**ボタン

#### 6.1.1 CSV出力の手順

1. **CSV出力**ボタンをクリックします
2. **出力期間**を選択します：
   - **開始期間**: 開始年月を選択
   - **終了期間**: 終了年月を選択

3. **出力項目**を選択します：
   - チェックボックスで出力する項目を選択
   - **すべて選択**/**すべて解除**ボタンで一括選択・解除が可能

4. **CSV出力**ボタンをクリックします
5. CSVファイルがダウンロードされます

#### 6.1.2 出力されるデータ

- 選択した期間内のすべての日次売上データが出力されます
- 日付ごとに1行として出力されます
- 選択した項目のみが出力されます

#### 6.1.3 CSVファイルの形式

- **文字コード**: UTF-8（BOM付き）
- **区切り文字**: カンマ（,）
- **ファイル名**: `売上データ_YYYY年MM月_YYYY年MM月.csv`

### 6.2 月次売上管理のCSV出力

**アクセス**: `/admin/monthly-sales` → **CSV出力**ボタン

#### 6.2.1 CSV出力の手順

1. **CSV出力**ボタンをクリックします
2. **出力期間**を選択します：
   - **開始期間**: 開始年月を選択
   - **終了期間**: 終了年月を選択

3. **出力項目**を選択します：
   - チェックボックスで出力する項目を選択
   - **すべて選択**/**すべて解除**ボタンで一括選択・解除が可能

4. **CSV出力**ボタンをクリックします
5. CSVファイルがダウンロードされます

#### 6.2.2 出力されるデータ

- 選択した期間内のすべての月次売上データが出力されます
- 店舗・年月ごとに1行として出力されます
- 選択した項目のみが出力されます

#### 6.2.3 CSVファイルの形式

- **文字コード**: UTF-8（BOM付き）
- **区切り文字**: カンマ（,）
- **ファイル名**: `月次売上データ_YYYY年MM月_YYYY年MM月.csv`

### 6.3 CSVファイルの開き方

#### Excelで開く場合

1. Excelを起動します
2. **ファイル** → **開く**を選択します
3. CSVファイルを選択します
4. **文字コード**: UTF-8を選択します
5. **区切り文字**: カンマを選択します

#### 注意事項

- CSVファイルはUTF-8（BOM付き）で保存されています
- Excelで開く際は、文字化けしないようにUTF-8を選択してください
- 数値データは文字列として扱われる場合があります

---

## 7. よくある質問

### 7.1 ログイン関連

**Q: パスワードを忘れてしまいました**

A: 管理者または総管理者に連絡して、パスワードのリセットを依頼してください。

**Q: ログインできない**

A: 以下を確認してください：
- 従業員IDとパスワードが正しいか
- アカウントが有効になっているか（管理者に確認）
- ブラウザのキャッシュをクリアしてみる

### 7.2 シフト管理関連

**Q: シフトを提出した後、修正したい**

A: 提出後は編集できません。管理者に連絡して、シフトの取り消しを依頼してください。

**Q: 提出期限を過ぎてしまいました**

A: 管理者に連絡して、提出期限の延長を依頼してください。

**Q: シフトのExcel出力ができない**

A: 以下を確認してください：
- 店舗と期間が正しく選択されているか
- シフト提出データが存在するか
- ブラウザのポップアップブロックが有効になっていないか

### 7.3 売上管理関連

**Q: データが表示されない**

A: 以下を確認してください：
- 店舗と年月が正しく選択されているか
- **更新**ボタンをクリックして最新データを取得する
- データが実際に存在するか（管理者に確認）

**Q: データを保存できない**

A: 以下を確認してください：
- 必須項目が入力されているか
- 数値項目に正しい形式で入力されているか
- ネットワーク接続が正常か

**Q: CSV出力ができない**

A: 以下を確認してください：
- 出力期間と項目が正しく選択されているか
- データが存在するか
- ブラウザのポップアップブロックが有効になっていないか

### 7.4 その他

**Q: 画面が表示されない**

A: 以下を確認してください：
- ブラウザのキャッシュをクリアする
- ブラウザを最新版に更新する
- JavaScriptが有効になっているか

**Q: エラーメッセージが表示される**

A: エラーメッセージの内容を確認し、管理者または総管理者に連絡してください。

**Q: 権限がないと表示される**

A: その機能を使用する権限がない可能性があります。管理者または総管理者に連絡して、権限の確認を依頼してください。

---

## 8. サポート・お問い合わせ

### 8.1 サポート窓口

システムに関するお問い合わせは、以下の窓口までご連絡ください：

- **管理者**: 所属店舗の管理者
- **総管理者**: システム管理者

### 8.2 バグ報告

システムの不具合を発見した場合は、以下の情報を含めて報告してください：

- **発生日時**: いつ発生したか
- **操作内容**: 何をしていたか
- **エラーメッセージ**: 表示されたエラーメッセージ
- **ブラウザ**: 使用しているブラウザとバージョン
- **スクリーンショット**: 可能であればスクリーンショットを添付

---

## 9. 更新履歴

### v2.0.0 (2025年12月)

- CSV出力機能の追加（売上管理・月次売上管理）
- 取引先管理の機能拡張（定期支払いの月選択機能）
- 権限チェックの改善
- エラーハンドリングの改善

### v1.0.0 (2024年7月)

- 初回リリース
- シフト管理機能
- 売上管理機能
- 損益管理機能
- 支払い管理機能
- 取引先管理機能
- 従業員管理機能
- 店舗管理機能

---

**最終更新**: 2025年12月  
**バージョン**: 2.0.0  
**作成者**: システム開発チーム

