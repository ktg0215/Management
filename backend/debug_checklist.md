# デバッグチェックリスト

## 1. 認証・権限システム

### 1.1 ログイン機能
- [ ] 正しい認証情報でログイン成功
- [ ] 間違った認証情報でエラー表示
- [ ] ロール別のリダイレクト（user → `/employee/dashboard`, admin/super_admin → `/admin/dashboard`）
- [ ] JWTトークンの保存と検証
- [ ] セッションタイムアウトの処理
- [ ] ログアウト機能の動作確認

### 1.2 権限制御
- [ ] `hasPermission()`関数の動作確認
- [ ] `isUser()`, `isAdmin()`, `isSuperAdmin()`の動作確認
- [ ] 権限のないページへのアクセス時のエラーハンドリング
- [ ] 権限に応じたナビゲーションメニューの表示/非表示

**テストユーザー**:
- 一般ユーザー: `test_user_1` (パスワード: `test123`)
- 管理者: `test_admin_1` (パスワード: `admin123`)
- スーパー管理者: `test_super_admin` (パスワード: `super123`)

## 2. 一般ユーザー (user) 機能

### 2.1 ダッシュボード (`/employee/dashboard`)
- [ ] 自分の情報の表示
- [ ] シフト提出状況の表示
- [ ] ナビゲーションメニューの表示（シフト提出のみ）
- [ ] 管理者機能へのアクセス不可の確認

### 2.2 シフト提出 (`/employee/shifts`)
- [ ] シフト期間の選択（前半/後半）
- [ ] カレンダー表示
- [ ] 出勤時間・退勤時間の入力
- [ ] 休日設定
- [ ] シフトデータの保存
- [ ] 提出済みシフトの確認
- [ ] 提出期限の表示
- [ ] 期限切れ後の編集制限

## 3. 管理者 (admin) 機能

### 3.1 ダッシュボード (`/admin/dashboard`)
- [ ] 所属業態の店舗一覧表示
- [ ] 活動ログの表示（所属業態のみ）
- [ ] ナビゲーションメニューの表示
- [ ] スーパー管理者機能へのアクセス不可の確認

### 3.2 シフト管理 (`/admin/shifts`)
- [ ] 店舗選択（所属業態の店舗のみ）
- [ ] シフト期間の選択
- [ ] 従業員シフト一覧の表示
- [ ] 提出状況の確認
- [ ] Excel出力機能（15日、30日、31日が正しく反映されるか）
- [ ] 期間選択の動作（1ヶ月前から3ヶ月後まで）

### 3.3 売上管理 (`/admin/sales-management`)
- [ ] 店舗選択
- [ ] 年月選択
- [ ] 日次売上データの表示
- [ ] データ入力機能
- [ ] データ更新機能
- [ ] 表示項目設定タブ
- [ ] フィールドの表示/非表示設定
- [ ] データの保存と読み込み

### 3.4 月次売上管理 (`/admin/monthly-sales`)
- [ ] 店舗選択
- [ ] 年選択
- [ ] 月次データの表示
- [ ] データ編集機能
- [ ] フィールド設定タブ（スーパー管理者のみ）

### 3.5 支払い管理 (`/admin/payments`)
- [ ] 店舗選択
- [ ] 年月選択
- [ ] カテゴリ別の支払い一覧表示
- [ ] 月次支払総額の計算（小数点以下なし）
- [ ] 支払い金額の編集
- [ ] 取引先の表示/非表示切り替え
- [ ] データの保存

### 3.6 取引先管理 (`/admin/companies`)
- [ ] 店舗選択
- [ ] 取引先一覧の表示
- [ ] 取引先の新規作成
- [ ] 取引先の編集
- [ ] 取引先の削除（関連支払いデータがある場合のエラーハンドリング）
- [ ] 経費科目の選択（PL科目すべてを含む）
- [ ] 支払いタイプの選択（定期/特定月/不定期）
- [ ] 特定月の選択（定期支払い（選択した月）の場合）
- [ ] 検索・フィルタ機能

### 3.7 損益管理 (P&L) (`/admin/pl-create`, `/admin/yearly-progress`)
- [ ] 店舗選択
- [ ] 年月選択
- [ ] P&Lデータの作成
- [ ] P&Lデータの編集
- [ ] 科目の追加・削除
- [ ] 年間進捗の表示
- [ ] データの保存

### 3.8 従業員管理 (`/admin/employees`)
- [ ] 所属業態の従業員一覧表示
- [ ] 従業員の新規作成
- [ ] 従業員の編集
- [ ] 従業員の削除
- [ ] 権限の変更（user/admin）
- [ ] 店舗の変更

### 3.9 店舗管理 (`/admin/stores`)
- [ ] 所属業態の店舗一覧表示（閲覧のみ）
- [ ] スーパー管理者機能へのアクセス不可の確認

## 4. スーパー管理者 (super_admin) 機能

### 4.1 ダッシュボード (`/admin/dashboard`)
- [ ] 全業態・全店舗の表示
- [ ] 活動ログの表示（全業態）
- [ ] 全機能へのアクセス可能

### 4.2 業態管理 (`/admin/business-types`)
- [ ] 業態一覧の表示
- [ ] 業態の新規作成
- [ ] 業態の編集
- [ ] 業態の削除

### 4.3 店舗管理（全権限） (`/admin/stores`)
- [ ] 全店舗の一覧表示
- [ ] 店舗の新規作成
- [ ] 店舗の編集
- [ ] 店舗の削除
- [ ] 業態の割り当て

### 4.4 従業員管理（全権限） (`/admin/employees`)
- [ ] 全従業員の一覧表示
- [ ] 全店舗の従業員管理
- [ ] スーパー管理者アカウントの作成

### 4.5 管理者追加 (`/admin/add-admin`)
- [ ] 管理者アカウントの作成
- [ ] スーパー管理者アカウントの作成
- [ ] 権限の選択

### 4.6 売上管理表示項目設定 (`/admin/sales-field-settings`)
- [ ] 業態選択
- [ ] フィールド一覧の表示（売上管理に表示されているすべての項目）
- [ ] フィールドの表示/非表示設定
- [ ] フィールドの編集可否設定
- [ ] フィールドの並び順変更
- [ ] フィールドの追加・削除
- [ ] 設定の保存

## 5. APIエンドポイント

### 5.1 認証API
- [ ] `POST /api/auth/login`
- [ ] `POST /api/auth/register`
- [ ] `POST /api/auth/logout`
- [ ] `GET /api/auth/me`

### 5.2 シフトAPI
- [ ] `GET /api/shift-periods`
- [ ] `GET /api/shift-submissions`
- [ ] `GET /api/shift-entries`
- [ ] `POST /api/shift-entries`
- [ ] `PUT /api/shift-entries/:id`
- [ ] `DELETE /api/shift-entries/:id`
- [ ] `GET /api/shift-export-excel`

### 5.3 売上API
- [ ] `GET /api/sales`
- [ ] `POST /api/sales`
- [ ] `GET /api/sales/monthly-summary`
- [ ] `GET /api/business-type-fields`
- [ ] `POST /api/business-type-fields`

### 5.4 支払い・取引先API
- [ ] `GET /api/payments`
- [ ] `POST /api/payments/bulk`
- [ ] `GET /api/companies`
- [ ] `POST /api/companies`
- [ ] `PUT /api/companies/:id`
- [ ] `DELETE /api/companies/:id`
- [ ] `GET /api/pl/subjects`

### 5.5 P&L API
- [ ] `GET /api/pl`
- [ ] `POST /api/pl`
- [ ] `PUT /api/pl/:id`

### 5.6 従業員・店舗・業態API
- [ ] `GET /api/employees`
- [ ] `POST /api/employees`
- [ ] `PUT /api/employees/:id`
- [ ] `DELETE /api/employees/:id`
- [ ] `GET /api/stores`
- [ ] `POST /api/stores`
- [ ] `PUT /api/stores/:id`
- [ ] `DELETE /api/stores/:id`
- [ ] `GET /api/business-types`
- [ ] `POST /api/business-types`
- [ ] `PUT /api/business-types/:id`
- [ ] `DELETE /api/business-types/:id`

## 6. 共通機能

### 6.1 エラーハンドリング
- [ ] ネットワークエラーの処理
- [ ] 認証エラー（401）の処理
- [ ] 権限エラー（403）の処理
- [ ] バリデーションエラーの表示
- [ ] サーバーエラー（500）の処理
- [ ] エラーメッセージの日本語表示

### 6.2 データ整合性
- [ ] 外部キー制約の動作確認
- [ ] 削除時の関連データチェック
- [ ] データの重複チェック
- [ ] 日付範囲のバリデーション

### 6.3 UI/UX
- [ ] レスポンシブデザイン（モバイル・タブレット・PC）
- [ ] ローディング状態の表示
- [ ] フォームバリデーション
- [ ] 確認ダイアログの表示
- [ ] 成功メッセージの表示

## 7. 発見された問題点

### 7.1 クリティカル（即座に修正が必要）
（記録用）

### 7.2 高（早急に修正が必要）
（記録用）

### 7.3 中（修正推奨）
（記録用）

### 7.4 低（改善提案）
（記録用）

